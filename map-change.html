<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>マップ変換くん</title>
<style>
body {
    font-family: monospace;
    background: #111;
    color: #eee;
    padding: 20px;
}
textarea {
    width: 100%;
    height: 240px;
    background: #000;
    color: #0f0;
    border: 1px solid #555;
    padding: 10px;
}
input, button {
    font-size: 16px;
    margin-top: 6px;
}
button {
    padding: 6px 14px;
}
label {
    display: block;
    margin-top: 12px;
}
</style>
</head>
<body>

<h2>マップ変換くん</h2>
<p>ver0.1</p>
<p>©なーくるる2026</p>
<p>！コメントアウト部分・変数は変換されません！</p>
<label>① マップファイルを貼り付け</label>
<textarea id="inputText"></textarea>

<label>② 増減させる距離（m）※マイナス可</label>
<input type="number" id="offset" step="0.01" value="0">

<br>
<button onclick="convert()">変換</button>

<label>③ 出力</label>
<textarea id="outputText"></textarea>

<script>
function convert() {
    const input = document.getElementById("inputText").value;
    const offset = parseFloat(document.getElementById("offset").value) || 0;

    const lines = input.split("\n");

    const output = lines.map(line => {
        if (/^\s*[;#]/.test(line)) return line;
        const match = line.match(/^(\s*)(-?\d+(?:\.\d+)?)(\s*;.*)$/);
        if (!match) return line;

        const prefix = match[1];
        const distance = parseFloat(match[2]);
        const suffix = match[3];

        let newDistance = distance + offset;
        newDistance = newDistance.toFixed(3).replace(/\.?0+$/, "");

        return prefix + newDistance + suffix;
    });

    document.getElementById("outputText").value = output.join("\n");
}
</script>

</body>
</html>
